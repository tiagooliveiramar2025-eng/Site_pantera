<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fichas - Pantera</title>
<style>
  body {
    background-color: #004aad;
    color: white;
    font-family: Arial, sans-serif;
    text-align: center;
    padding: 50px;
  }
  input, button {
    padding: 10px;
    margin: 5px;
    font-size: 16px;
  }
  #adminButtons {
    margin-top: 20px;
  }
</style>
<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
</head>
<body>

<h1>Fichas - Pantera</h1>

<input type="text" id="fichaName" placeholder="Digite o nome da ficha">
<button id="searchBtn">Buscar</button>
<button id="toggleAdmin">Senha</button>

<div id="adminButtons" style="display:none;">
  <button id="addFichaBtn">Adicionar Ficha</button>
  <button id="addHoursBtn">Adicionar Horas</button>
  <button id="deleteFichaBtn">Apagar Ficha</button>
</div>

<ul id="fichaList"></ul>

<script>
  // Configuração do Firebase
  const firebaseConfig = {
    apiKey: "SUA_API_KEY",
    authDomain: "SEU_PROJECT_ID.firebaseapp.com",
    projectId: "SEU_PROJECT_ID",
    storageBucket: "SEU_PROJECT_ID.appspot.com",
    messagingSenderId: "SENDER_ID",
    appId: "APP_ID"
  };

  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();
  const fichaList = document.getElementById('fichaList');

  const fichaNameInput = document.getElementById('fichaName');
  const searchBtn = document.getElementById('searchBtn');
  const toggleAdmin = document.getElementById('toggleAdmin');
  const adminButtons = document.getElementById('adminButtons');

  // Mostrar/Esconder botões de admin
  toggleAdmin.addEventListener('click', () => {
    if(adminButtons.style.display === 'none'){
      adminButtons.style.display = 'block';
    } else {
      adminButtons.style.display = 'none';
    }
  });

  // Buscar ficha
  searchBtn.addEventListener('click', async () => {
    fichaList.innerHTML = '';
    const name = fichaNameInput.value.trim().toLowerCase();
    if(!name) return;

    const snapshot = await db.collection('fichas').where('nome', '==', name).get();
    if(snapshot.empty){
      fichaList.innerHTML = '<li>Nenhuma ficha encontrada.</li>';
    } else {
      snapshot.forEach(doc => {
        const li = document.createElement('li');
        li.textContent = `Nome: ${doc.data().nome} | Horas: ${doc.data().horas || 0}`;
        fichaList.appendChild(li);
      });
    }
  });

  // Adicionar ficha
  document.getElementById('addFichaBtn').addEventListener('click', async () => {
    const name = fichaNameInput.value.trim().toLowerCase();
    if(!name) return alert('Digite o nome da ficha!');

    await db.collection('fichas').add({ nome: name, horas: 0 });
    alert('Ficha adicionada!');
  });

  // Adicionar horas
  document.getElementById('addHoursBtn').addEventListener('click', async () => {
    const name = fichaNameInput.value.trim().toLowerCase();
    if(!name) return alert('Digite o nome da ficha!');

    const snapshot = await db.collection('fichas').where('nome', '==', name).get();
    if(snapshot.empty) return alert('Ficha não encontrada!');

    snapshot.forEach(async doc => {
      const currentHours = doc.data().horas || 0;
      await db.collection('fichas').doc(doc.id).update({ horas: currentHours + 1 });
    });
    alert('Horas adicionadas!');
  });

  // Apagar ficha
  document.getElementById('deleteFichaBtn').addEventListener('click', async () => {
    const name = fichaNameInput.value.trim().toLowerCase();
    if(!name) return alert('Digite o nome da ficha!');

    const snapshot = await db.collection('fichas').where('nome', '==', name).get();
    if(snapshot.empty) return alert('Ficha não encontrada!');

    snapshot.forEach(async doc => {
      await db.collection('fichas').doc(doc.id).delete();
    });
    alert('Ficha apagada!');
  });

</script>
</body>
</html>
